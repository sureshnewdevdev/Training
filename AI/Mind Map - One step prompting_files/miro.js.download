"use strict";(()=>{var k=Object.defineProperty;var o=(n,e)=>k(n,"name",{value:e,configurable:!0});var g=class g extends Error{constructor(e){super(e),this.name="SdkMethodExecutionError"}};o(g,"SdkMethodExecutionError");var d=g;var u=class u extends Error{constructor(e,r){super(e),this.name="SdkConnectionError",r instanceof Error&&(this.stack=`${this.stack}
Caused by: ${r.stack}`)}};o(u,"SdkConnectionError");var i=u;var w=new Promise(()=>{});function y(n,e,r){let t,c=n.then(a=>(t=r?a[r]:a,t)).catch(a=>{if(a instanceof i)return w;throw a});return{path:e,realAsyncTarget:c,get realSyncedTarget(){return t},proxyTarget:a=>{let p=n.then(s=>{let m=typeof s=="function"?s()[r](...a):s[r](...a);return m&&typeof m.then=="function"?()=>m:m}).catch(s=>{if(s instanceof i)return w;throw new d(`Cannot call the method ".${r}()" at path "${e.join(".")}".
  - ${s.message}`)});return l(y(p,e))}}}o(y,"createSegment");function l(n){return new Proxy(n.proxyTarget,{get:(e,r)=>l(y(n.realAsyncTarget,[...n.path,r],r)),apply:(e,r,t)=>{let c=n.realSyncedTarget;return c?c(...t):e(t)}})}o(l,"createProxyLevel");function T(n){return l(y(n,[]))}o(T,"createLazyObjectProxy");var P=(()=>{let n={createScriptURL:e=>e};try{return window.trustedTypes?.createPolicy("miro-importer",{createScriptURL:e=>e})??n}catch{return n}})();function h(n){return new Promise((e,r)=>{let t=document.createElement("script");t.src=P.createScriptURL(n),t.onload=e,t.onerror=r,document.head.appendChild(t)})}o(h,"loadScript");var f="sdkv2-plugin-message",x="SDK_REQUEST_VERSION";async function M(n){let e=Math.random().toString(36).slice(-10);return Promise.race([new Promise((r,t)=>setTimeout(()=>t(new i("SDK version fetching timeout")),1e4)),new Promise((r,t)=>{let c=o(a=>{if(a.data?.commandId!==f)return;let s=a.data?.payload?.find(({id:m})=>m===e)?.payload?.sdk;s&&r(new URL(s)),t(new i("SDK version can't be received")),window.removeEventListener("message",c)},"handleMessage");window.addEventListener("message",c),window.parent.postMessage({commandId:f,payload:[{id:e,name:x,payload:{sdkVariant:n}}],msgId:e},"*")})])}o(M,"requestMiroVersion");async function E(){let n=new URL(document.location.href);try{let e=n.searchParams.get("_sdk"),r=await M(e);return await h(r.href),window.miro}catch(e){throw new i("Miro SDK is not connected. Ensure your app is running within the Miro environment.",e)}}o(E,"loadMiroSDK");var S=E();window.miro=T(S);S.catch(n=>console.error(n));})();
