<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySQL to BigQuery Data Insertion - Complete Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #4285f4;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        .content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
        }
        
        h2 {
            color: #4285f4;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #f0f0f0;
            display: flex;
            align-items: center;
        }
        
        h2 i {
            margin-right: 10px;
        }
        
        h3 {
            color: #ea4335;
            margin: 25px 0 15px;
            display: flex;
            align-items: center;
        }
        
        h3 i {
            margin-right: 8px;
        }
        
        p {
            margin-bottom: 15px;
            font-size: 1.05rem;
        }
        
        ul, ol {
            margin-left: 25px;
            margin-bottom: 20px;
        }
        
        li {
            margin-bottom: 12px;
            font-size: 1.05rem;
        }
        
        .step-number {
            background: #4285f4;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .definition {
            background-color: #e8f0fe;
            border-left: 5px solid #4285f4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .important {
            background-color: #fce8e6;
            border-left: 5px solid #ea4335;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .tip {
            background-color: #e6f4ea;
            border-left: 5px solid #34a853;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .warning {
            background-color: #fef7e0;
            border-left: 5px solid #fbbc05;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.4;
        }
        
        .sql-keyword {
            color: #f92672;
        }
        
        .sql-function {
            color: #66d9ef;
        }
        
        .sql-string {
            color: #e6db74;
        }
        
        .sql-comment {
            color: #75715e;
        }
        
        .sql-table {
            color: #a6e22e;
        }
        
        .python-keyword {
            color: #f92672;
        }
        
        .python-function {
            color: #66d9ef;
        }
        
        .python-string {
            color: #e6db74;
        }
        
        .python-comment {
            color: #75715e;
        }
        
        .bash-comment {
            color: #75715e;
        }
        
        .steps-container {
            counter-reset: step-counter;
        }
        
        .step {
            margin-bottom: 30px;
            padding-left: 60px;
            position: relative;
        }
        
        .step:before {
            counter-increment: step-counter;
            content: counter(step-counter);
            background: #4285f4;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            left: 0;
            top: 0;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .step-title {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #4285f4;
        }
        
        .file-content {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
        }
        
        .btn {
            display: inline-block;
            background: #4285f4;
            color: white;
            padding: 12px 25px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s ease;
            margin: 10px 5px;
            border: none;
            cursor: pointer;
        }
        
        .btn:hover {
            background: #3367d6;
        }
        
        .method-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .method-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #4285f4;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .method-card:hover {
            transform: translateY(-5px);
        }
        
        .method-card h4 {
            color: #4285f4;
            margin-bottom: 10px;
        }
        
        .method-card.active {
            background: #e8f0fe;
            border-left: 4px solid #ea4335;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .step {
                padding-left: 50px;
            }
            
            .step:before {
                width: 35px;
                height: 35px;
            }
            
            .method-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>MySQL to BigQuery Data Insertion</h1>
            <p class="subtitle">Complete Step-by-Step Guide: Export from MySQL and Import to BigQuery</p>
            <p>Learn multiple methods to transfer data from your local MySQL to Google BigQuery</p>
        </header>
        
        <div class="content">
            <div class="card">
                <h2><i class="fas fa-database"></i> Overview</h2>
                
                <p>This guide covers comprehensive methods to transfer data from MySQL running on your local machine to Google BigQuery.</p>
                
                <div class="definition">
                    <p><strong>Available Methods:</strong></p>
                    <ol>
                        <li>CSV Export/Import (Most Common)</li>
                        <li>Python Script with Direct Transfer</li>
                        <li>MySQL Command Line + Google Cloud SDK</li>
                        <li>Google Cloud Dataflow (For Large Datasets)</li>
                    </ol>
                </div>
                
                <div class="tip">
                    <p><i class="fas fa-lightbulb"></i> <strong>Prerequisites:</strong> 
                    MySQL installed locally, Google Cloud account, BigQuery dataset created, Google Cloud SDK installed (optional).</p>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-table"></i> Sample MySQL Data Setup</h2>
                
                <div class="steps-container">
                    <div class="step">
                        <div class="step-title">Create Sample MySQL Database and Table</div>
                        <p>First, let's create a sample database and table in MySQL:</p>
                        
                        <div class="code-block">
                            <span class="sql-comment">-- Connect to MySQL</span><br>
                            mysql -u root -p<br>
                            <br>
                            <span class="sql-comment">-- Create database</span><br>
                            <span class="sql-keyword">CREATE DATABASE</span> company_db;<br>
                            <span class="sql-keyword">USE</span> company_db;<br>
                            <br>
                            <span class="sql-comment">-- Create customers table</span><br>
                            <span class="sql-keyword">CREATE TABLE</span> customers (<br>
                            &nbsp;&nbsp;customer_id <span class="sql-keyword">INT AUTO_INCREMENT PRIMARY KEY</span>,<br>
                            &nbsp;&nbsp;first_name <span class="sql-keyword">VARCHAR</span>(50) <span class="sql-keyword">NOT NULL</span>,<br>
                            &nbsp;&nbsp;last_name <span class="sql-keyword">VARCHAR</span>(50) <span class="sql-keyword">NOT NULL</span>,<br>
                            &nbsp;&nbsp;email <span class="sql-keyword">VARCHAR</span>(100) <span class="sql-keyword">UNIQUE</span>,<br>
                            &nbsp;&nbsp;phone <span class="sql-keyword">VARCHAR</span>(20),<br>
                            &nbsp;&nbsp;city <span class="sql-keyword">VARCHAR</span>(50),<br>
                            &nbsp;&nbsp;country <span class="sql-keyword">VARCHAR</span>(50),<br>
                            &nbsp;&nbsp;registration_date <span class="sql-keyword">DATE</span>,<br>
                            &nbsp;&nbsp;total_orders <span class="sql-keyword">INT DEFAULT</span> 0,<br>
                            &nbsp;&nbsp;total_spent <span class="sql-keyword">DECIMAL</span>(10,2) <span class="sql-keyword">DEFAULT</span> 0.00<br>
                            );<br>
                            <br>
                            <span class="sql-comment">-- Insert sample data</span><br>
                            <span class="sql-keyword">INSERT INTO</span> customers (first_name, last_name, email, phone, city, country, registration_date, total_orders, total_spent) <span class="sql-keyword">VALUES</span><br>
                            &nbsp;&nbsp;(<span class="sql-string">'John'</span>, <span class="sql-string">'Smith'</span>, <span class="sql-string">'john.smith@email.com'</span>, <span class="sql-string">'+1-555-0101'</span>, <span class="sql-string">'New York'</span>, <span class="sql-string">'USA'</span>, <span class="sql-string">'2022-03-15'</span>, 12, 2450.75),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'Maria'</span>, <span class="sql-string">'Garcia'</span>, <span class="sql-string">'maria.garcia@email.com'</span>, <span class="sql-string">'+1-555-0102'</span>, <span class="sql-string">'Los Angeles'</span>, <span class="sql-string">'USA'</span>, <span class="sql-string">'2022-05-20'</span>, 8, 1200.50),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'David'</span>, <span class="sql-string">'Johnson'</span>, <span class="sql-string">'david.johnson@email.com'</span>, <span class="sql-string">'+1-555-0103'</span>, <span class="sql-string">'Chicago'</span>, <span class="sql-string">'USA'</span>, <span class="sql-string">'2022-07-10'</span>, 15, 3100.25),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'Sarah'</span>, <span class="sql-string">'Williams'</span>, <span class="sql-string">'sarah.williams@email.com'</span>, <span class="sql-string">'+44-20-7946-0958'</span>, <span class="sql-string">'London'</span>, <span class="sql-string">'UK'</span>, <span class="sql-string">'2022-02-28'</span>, 5, 875.80),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'Michael'</span>, <span class="sql-string">'Brown'</span>, <span class="sql-string">'michael.brown@email.com'</span>, <span class="sql-string">'+61-2-9876-5432'</span>, <span class="sql-string">'Sydney'</span>, <span class="sql-string">'Australia'</span>, <span class="sql-string">'2022-09-05'</span>, 3, 450.30),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'Emma'</span>, <span class="sql-string">'Davis'</span>, <span class="sql-string">'emma.davis@email.com'</span>, <span class="sql-string">'+1-555-0104'</span>, <span class="sql-string">'Toronto'</span>, <span class="sql-string">'Canada'</span>, <span class="sql-string">'2022-11-12'</span>, 7, 980.45),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'James'</span>, <span class="sql-string">'Miller'</span>, <span class="sql-string">'james.miller@email.com'</span>, <span class="sql-string">'+49-30-123456'</span>, <span class="sql-string">'Berlin'</span>, <span class="sql-string">'Germany'</span>, <span class="sql-string">'2022-04-18'</span>, 10, 1650.90),<br>
                            &nbsp;&nbsp;(<span class="sql-string">'Lisa'</span>, <span class="sql-string">'Wilson'</span>, <span class="sql-string">'lisa.wilson@email.com'</span>, <span class="sql-string">'+81-3-1234-5678'</span>, <span class="sql-string">'Tokyo'</span>, <span class="sql-string">'Japan'</span>, <span class="sql-string">'2022-08-22'</span>, 6, 1120.60);<br>
                            <br>
                            <span class="sql-comment">-- Verify data</span><br>
                            <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> customers;
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-file-export"></i> Method 1: CSV Export/Import</h2>
                
                <div class="steps-container">
                    <div class="step">
                        <div class="step-title">Step 1: Export MySQL Data to CSV</div>
                        
                        <h4>Option A: Using MySQL Command Line (if you have FILE privilege)</h4>
                        <div class="code-block">
                            <span class="sql-comment"># Export to CSV with proper formatting</span><br>
                            mysql -u root -p company_db -e <span class="sql-string">"SELECT * FROM customers"</span> \<br>
                            | sed <span class="sql-string">'s/\t/","/g'</span> \<br>
                            | sed <span class="sql-string">'s/^/"/; s/$/"/'</span> \<br>
                            | sed <span class="sql-string">'1s/^/"customer_id","first_name","last_name","email","phone","city","country","registration_date","total_orders","total_spent"\n/'</span> \<br>
                            > customers.csv
                        </div>

                        <h4>Option B: Using MySQL SELECT INTO OUTFILE</h4>
                        <div class="code-block">
                            <span class="sql-comment">-- Execute in MySQL</span><br>
                            <span class="sql-keyword">SELECT</span> <span class="sql-string">'customer_id'</span>,<span class="sql-string">'first_name'</span>,<span class="sql-string">'last_name'</span>,<span class="sql-string">'email'</span>,<span class="sql-string">'phone'</span>,<span class="sql-string">'city'</span>,<span class="sql-string">'country'</span>,<span class="sql-string">'registration_date'</span>,<span class="sql-string">'total_orders'</span>,<span class="sql-string">'total_spent'</span><br>
                            <span class="sql-keyword">UNION ALL</span><br>
                            <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> customers<br>
                            <span class="sql-keyword">INTO OUTFILE</span> <span class="sql-string">'/tmp/customers.csv'</span><br>
                            <span class="sql-keyword">FIELDS TERMINATED BY</span> <span class="sql-string">','</span><br>
                            <span class="sql-keyword">ENCLOSED BY</span> <span class="sql-string">'"'</span><br>
                            <span class="sql-keyword">LINES TERMINATED BY</span> <span class="sql-string">'\n'</span>;
                        </div>

                        <h4>Option C: Using MySQL Workbench or phpMyAdmin</h4>
                        <ol>
                            <li>Open MySQL Workbench or phpMyAdmin</li>
                            <li>Connect to your database</li>
                            <li>Run: <code>SELECT * FROM customers</code></li>
                            <li>Click "Export" and choose CSV format</li>
                            <li>Save as <code>customers.csv</code></li>
                        </ol>
                    </div>

                    <div class="step">
                        <div class="step-title">Step 2: Upload CSV to Google Cloud Storage</div>
                        <ol>
                            <li>Go to <a href="https://console.cloud.google.com/storage" target="_blank">Google Cloud Storage</a></li>
                            <li>Create a bucket (if you don't have one):
                                <ul>
                                    <li>Click "Create Bucket"</li>
                                    <li>Enter unique bucket name: <code>mysql-export-bucket-[your-project-id]</code></li>
                                    <li>Choose location type</li>
                                    <li>Click "Create"</li>
                                </ul>
                            </li>
                            <li>Upload your CSV file:
                                <ul>
                                    <li>Click on your bucket</li>
                                    <li>Click "Upload Files"</li>
                                    <li>Select <code>customers.csv</code></li>
                                    <li>Wait for upload to complete</li>
                                </ul>
                            </li>
                            <li>Note the file path: <code>gs://your-bucket-name/customers.csv</code></li>
                        </ol>
                    </div>

                    <div class="step">
                        <div class="step-title">Step 3: Create Table in BigQuery from CSV</div>
                        
                        <h4>Using BigQuery Web UI:</h4>
                        <ol>
                            <li>Open <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery Console</a></li>
                            <li>Select your project and dataset</li>
                            <li>Click "Create Table"</li>
                            <li>Source: Google Cloud Storage</li>
                            <li>File path: <code>gs://your-bucket-name/customers.csv</code></li>
                            <li>File format: CSV</li>
                            <li>Table name: <code>mysql_customers</code></li>
                            <li>Check "Auto detect" schema</li>
                            <li>Advanced options:
                                <ul>
                                    <li>Header rows to skip: 1</li>
                                    <li>Field delimiter: Comma</li>
                                    <li>Quote character: Double quote</li>
                                </ul>
                            </li>
                            <li>Click "Create Table"</li>
                        </ol>

                        <h4>Using SQL Command:</h4>
                        <div class="code-block">
                            <span class="sql-comment">-- Create table from CSV in BigQuery</span><br>
                            <span class="sql-keyword">CREATE OR REPLACE TABLE</span> <span class="sql-function">`your-project.your_dataset.mysql_customers`</span><br>
                            <span class="sql-keyword">OPTIONS</span>(<br>
                            &nbsp;&nbsp;description = <span class="sql-string">"Customers data imported from MySQL"</span><br>
                            )<br>
                            <span class="sql-keyword">AS</span><br>
                            <span class="sql-keyword">SELECT</span> * <br>
                            <span class="sql-keyword">FROM</span> <span class="sql-function">`your-project.your_dataset`.customers_csv</span>;<br>
                            <br>
                            <span class="sql-comment">-- Or use LOAD DATA command</span><br>
                            <span class="sql-keyword">LOAD DATA</span> <span class="sql-keyword">OVERWRITE</span> <span class="sql-function">`your-project.your_dataset.mysql_customers`</span><br>
                            <span class="sql-keyword">FROM FILES</span> (<br>
                            &nbsp;&nbsp;format = <span class="sql-string">'CSV'</span>,<br>
                            &nbsp;&nbsp;uris = [<span class="sql-string">'gs://your-bucket-name/customers.csv'</span>],<br>
                            &nbsp;&nbsp;skip_leading_rows = 1<br>
                            );
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-code"></i> Method 2: Python Script - Direct Transfer</h2>
                
                <div class="steps-container">
                    <div class="step">
                        <div class="step-title">Step 1: Install Required Packages</div>
                        <div class="code-block">
                            <span class="bash-comment"># Install required Python packages</span><br>
                            pip install mysql-connector-python<br>
                            pip install pandas-gbq<br>
                            pip install google-cloud-bigquery<br>
                            pip install pandas
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-title">Step 2: Create Python Script</div>
                        <p>Create a file called <code>mysql_to_bigquery.py</code>:</p>
                        
                        <div class="code-block">
                            <span class="python-comment">#!/usr/bin/env python3</span><br>
                            <span class="python-comment"># mysql_to_bigquery.py</span><br>
                            <span class="python-keyword">import</span> mysql.connector<br>
                            <span class="python-keyword">import</span> pandas <span class="python-keyword">as</span> pd<br>
                            <span class="python-keyword">from</span> google.cloud <span class="python-keyword">import</span> bigquery<br>
                            <span class="python-keyword">import</span> logging<br>
                            <br>
                            <span class="python-comment"># Set up logging</span><br>
                            logging.basicConfig(level=logging.INFO)<br>
                            logger = logging.getLogger(__name__)<br>
                            <br>
                            <span class="python-keyword">def</span> <span class="python-function">mysql_to_bigquery</span>():<br>
                            &nbsp;&nbsp;<span class="python-comment"># MySQL connection configuration</span><br>
                            &nbsp;&nbsp;mysql_config = {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-string">'host'</span>: <span class="python-string">'localhost'</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-string">'user'</span>: <span class="python-string">'root'</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-string">'password'</span>: <span class="python-string">'your_mysql_password'</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-string">'database'</span>: <span class="python-string">'company_db'</span><br>
                            &nbsp;&nbsp;}<br>
                            <br>
                            &nbsp;&nbsp;<span class="python-comment"># BigQuery configuration</span><br>
                            &nbsp;&nbsp;project_id = <span class="python-string">'your-gcp-project-id'</span><br>
                            &nbsp;&nbsp;dataset_id = <span class="python-string">'your_dataset'</span><br>
                            &nbsp;&nbsp;table_id = <span class="python-string">'mysql_customers_python'</span><br>
                            <br>
                            &nbsp;&nbsp;<span class="python-keyword">try</span>:<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;logger.info(<span class="python-string">"Connecting to MySQL..."</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Connect to MySQL</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;mysql_conn = mysql.connector.connect(**mysql_config)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Read data from MySQL</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;query = <span class="python-string">"SELECT * FROM customers"</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;df = pd.read_sql(query, mysql_conn)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;logger.info(<span class="python-string">f"Retrieved <span class="python-keyword">{</span>len(df)<span class="python-keyword">}</span> records from MySQL"</span>)<br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Close MySQL connection</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;mysql_conn.close()<br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Initialize BigQuery client</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;client = bigquery.Client(project=project_id)<br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Define table schema (optional - can be auto-detected)</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;schema = [<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"customer_id"</span>, <span class="python-string">"INTEGER"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"first_name"</span>, <span class="python-string">"STRING"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"last_name"</span>, <span class="python-string">"STRING"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"email"</span>, <span class="python-string">"STRING"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"phone"</span>, <span class="python-string">"STRING"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"city"</span>, <span class="python-string">"STRING"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"country"</span>, <span class="python-string">"STRING"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"registration_date"</span>, <span class="python-string">"DATE"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"total_orders"</span>, <span class="python-string">"INTEGER"</span>),<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigquery.SchemaField(<span class="python-string">"total_spent"</span>, <span class="python-string">"FLOAT"</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;]<br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Define table reference</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;table_ref = client.dataset(dataset_id).table(table_id)<br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Configure job</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;job_config = bigquery.LoadJobConfig(<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schema=schema,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_disposition=bigquery.WriteDisposition.WRITE_TRUNCATE,  <span class="python-comment"># Overwrite table</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source_format=bigquery.SourceFormat.CSV<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;)<br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;logger.info(<span class="python-string">"Uploading data to BigQuery..."</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-comment"># Upload to BigQuery</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;job = client.load_table_from_dataframe(<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;df, table_ref, job_config=job_config<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;job.result()  <span class="python-comment"># Wait for job to complete</span><br>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;logger.info(<span class="python-string">f"Successfully loaded <span class="python-keyword">{</span>job.output_rows<span class="python-keyword">}</span> rows into BigQuery"</span>)<br>
                            <br>
                            &nbsp;&nbsp;<span class="python-keyword">except</span> Exception <span class="python-keyword">as</span> e:<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;logger.error(<span class="python-string">f"Error: <span class="python-keyword">{</span>str(e)<span class="python-keyword">}</span>"</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="python-keyword">raise</span><br>
                            <br>
                            <span class="python-keyword">if</span> __name__ == <span class="python-string">"__main__"</span>:<br>
                            &nbsp;&nbsp;mysql_to_bigquery()<br>
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-title">Step 3: Run the Python Script</div>
                        <div class="code-block">
                            <span class="bash-comment"># Make sure you're authenticated with Google Cloud</span><br>
                            gcloud auth application-default login<br>
                            <br>
                            <span class="bash-comment"># Run the script</span><br>
                            python mysql_to_bigquery.py
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-terminal"></i> Method 3: Command Line Automation</h2>
                
                <div class="steps-container">
                    <div class="step">
                        <div class="step-title">Step 1: Create Shell Script</div>
                        <p>Create a file called <code>mysql_to_bigquery.sh</code>:</p>
                        
                        <div class="code-block">
                            <span class="bash-comment">#!/bin/bash</span><br>
                            <br>
                            <span class="bash-comment"># Configuration</span><br>
                            MYSQL_USER="root"<br>
                            MYSQL_PASSWORD="your_password"<br>
                            MYSQL_DATABASE="company_db"<br>
                            MYSQL_TABLE="customers"<br>
                            GCS_BUCKET="gs://your-bucket-name"<br>
                            PROJECT_ID="your-gcp-project-id"<br>
                            DATASET_ID="your_dataset"<br>
                            BQ_TABLE="mysql_customers_cli"<br>
                            <br>
                            <span class="bash-comment"># Export from MySQL to CSV</span><br>
                            echo "Exporting data from MySQL..."<br>
                            mysql -u $MYSQL_USER -p$MYSQL_PASSWORD $MYSQL_DATABASE -e "<br>
                            SELECT 'customer_id','first_name','last_name','email','phone','city','country','registration_date','total_orders','total_spent'<br>
                            UNION ALL<br>
                            SELECT * FROM $MYSQL_TABLE<br>
                            " | sed 's/\t/","/g' | sed 's/^/"/; s/$/"/' > customers.csv<br>
                            <br>
                            <span class="bash-comment"># Upload to Google Cloud Storage</span><br>
                            echo "Uploading to Google Cloud Storage..."<br>
                            gsutil cp customers.csv $GCS_BUCKET/<br>
                            <br>
                            <span class="bash-comment"># Load into BigQuery</span><br>
                            echo "Loading into BigQuery..."<br>
                            bq load --source_format=CSV --skip_leading_rows=1 --autodetect \<br>
                            $PROJECT_ID:$DATASET_ID.$BQ_TABLE \<br>
                            $GCS_BUCKET/customers.csv<br>
                            <br>
                            <span class="bash-comment"># Clean up local file</span><br>
                            rm customers.csv<br>
                            <br>
                            echo "Data transfer completed successfully!"
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-title">Step 2: Make Script Executable and Run</div>
                        <div class="code-block">
                            <span class="bash-comment"># Make the script executable</span><br>
                            chmod +x mysql_to_bigquery.sh<br>
                            <br>
                            <span class="bash-comment"># Run the script</span><br>
                            ./mysql_to_bigquery.sh
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-check-circle"></i> Verification Steps</h2>
                
                <div class="steps-container">
                    <div class="step">
                        <div class="step-title">Verify Data in BigQuery</div>
                        <p>Run these queries in BigQuery to verify your data was transferred correctly:</p>
                        
                        <div class="code-block">
                            <span class="sql-comment">-- Check row count matches</span><br>
                            <span class="sql-keyword">SELECT</span> <span class="sql-string">'BigQuery'</span> <span class="sql-keyword">AS</span> source, <span class="sql-function">COUNT</span>(*) <span class="sql-keyword">AS</span> row_count<br>
                            <span class="sql-keyword">FROM</span> <span class="sql-function">`your-project.your_dataset.mysql_customers`</span><br>
                            <span class="sql-keyword">UNION ALL</span><br>
                            <span class="sql-keyword">SELECT</span> <span class="sql-string">'MySQL'</span>, <span class="sql-function">COUNT</span>(*)<br>
                            <span class="sql-keyword">FROM</span> <span class="sql-function">`your-project.your_dataset`.INFORMATION_SCHEMA.TABLES</span><br>
                            <span class="sql-keyword">WHERE</span> table_name = <span class="sql-string">'mysql_customers'</span>;<br>
                            <br>
                            <span class="sql-comment">-- Check sample data</span><br>
                            <span class="sql-keyword">SELECT</span> *<br>
                            <span class="sql-keyword">FROM</span> <span class="sql-function">`your-project.your_dataset.mysql_customers`</span><br>
                            <span class="sql-keyword">ORDER BY</span> customer_id<br>
                            <span class="sql-keyword">LIMIT</span> 5;<br>
                            <br>
                            <span class="sql-comment">-- Check data types</span><br>
                            <span class="sql-keyword">SELECT</span> column_name, data_type<br>
                            <span class="sql-keyword">FROM</span> <span class="sql-function">`your-project.your_dataset`.INFORMATION_SCHEMA.COLUMNS</span><br>
                            <span class="sql-keyword">WHERE</span> table_name = <span class="sql-string">'mysql_customers'</span><br>
                            <span class="sql-keyword">ORDER BY</span> ordinal_position;
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2><i class="fas fa-rocket"></i> Summary & Best Practices</h2>
                
                <div class="definition">
                    <p><strong>Method Comparison:</strong></p>
                    <ul>
                        <li><strong>CSV Export/Import:</strong> Best for one-time transfers, simple setup</li>
                        <li><strong>Python Script:</strong> Best for automation, data transformation</li>
                        <li><strong>Command Line:</strong> Best for scheduled tasks, Unix environments</li>
                        <li><strong>Dataflow:</strong> Best for large datasets, real-time streaming</li>
                    </ul>
                </div>

                <div class="tip">
                    <p><i class="fas fa-lightbulb"></i> <strong>Best Practices:</strong></p>
                    <ul>
                        <li>Always test with small datasets first</li>
                        <li>Use proper error handling in scripts</li>
                        <li>Monitor BigQuery costs and set up alerts</li>
                        <li>Consider data type mapping between MySQL and BigQuery</li>
                        <li>Use partitioning and clustering in BigQuery for large tables</li>
                    </ul>
                </div>

                <div class="important">
                    <p><i class="fas fa-exclamation-circle"></i> <strong>Important Notes:</strong></p>
                    <ul>
                        <li>MySQL <code>DATETIME</code> maps to BigQuery <code>TIMESTAMP</code></li>
                        <li>MySQL <code>DECIMAL</code> maps to BigQuery <code>NUMERIC</code></li>
                        <li>Handle NULL values appropriately during export</li>
                        <li>Ensure character encoding is consistent (UTF-8 recommended)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Add interactive functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Copy code blocks on click
            const codeBlocks = document.querySelectorAll('.code-block');
            codeBlocks.forEach(block => {
                block.addEventListener('click', function() {
                    const text = this.innerText;
                    navigator.clipboard.writeText(text).then(() => {
                        const originalText = this.innerHTML;
                        this.innerHTML = '<i class="fas fa-check"></i> Copied to clipboard!';
                        setTimeout(() => {
                            this.innerHTML = originalText;
                        }, 2000);
                    });
                });
                
                block.style.cursor = 'pointer';
                block.title = 'Click to copy';
            });

            // Method cards selection
            const methodCards = document.querySelectorAll('.method-card');
            methodCards.forEach(card => {
                card.addEventListener('click', function() {
                    methodCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        });
    </script>
</body>
</html>